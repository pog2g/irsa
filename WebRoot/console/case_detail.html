<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>结案详情</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!-- Bootstrap 3.3.5 -->
    <link rel="stylesheet" href="res/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="res/font-awesome/css/font-awesome.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="res/ionicons/css/ionicons.min.css">
    <!-- iCheck for checkboxes and radio inputs -->
    <link rel="stylesheet" href="res/plugins/iCheck/all.css">
    <!-- Select2 -->
    <link rel="stylesheet" href="res/plugins/select2/select2.min.css">
    <!-- datetimepicker -->
    <link rel="stylesheet" href="res/plugins/datetimepicker/css/bootstrap-datetimepicker.min.css">
    <!-- switch -->
    <link rel="stylesheet" href="res/plugins/switch/bootstrap-switch.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="res/dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
     folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="res/dist/css/skins/_all-skins.min.css">
    <!-- 自定义 -->
    <link rel="shortcut icon" href="self/img/logo.png">
    <link rel="stylesheet" href="self/css/self.css">
    <link rel="stylesheet" href="self/css/add.css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">
    <header class="main-header"></header>
    <aside class="main-sidebar">
        <section class="sidebar">
            <ul class="sidebar-menu" id="ul_menu"></ul>
        </section>
    </aside>
    <div class="content-wrapper">
        <section class="content">
            <a id="arrow_left" class="btn btn-flat btn-skin btn-primary"
               style="position: fixed;right: 0;bottom: 20px;z-index: 50 !important;display:none;"><i
                    class="fa fa-arrow-left"></i></a>
            <div id="form_list" style="position: fixed;right: 0;bottom: 20px;z-index: 50 !important;display: none;">
                <div class="btn-group-vertical">
                    <a class="btn btn-flat btn-skin btn-primary" href="#topAnchor"><i
                            class="fa fa-arrow-circle-o-up"></i> 返回顶部</a>
                    <button class="btn btn-flat btn-skin btn-primary" id="arrow_right"><i
                            class="fa fa-arrow-circle-o-right"></i>
                        收起
                    </button>
                </div>
            </div>
            <div class="row">
                <!-- 左侧当事人详情主体开始 -->
                <div class="col-lg-7">
                    <div class="box box-solid no-shadow">
                        <div class="box-header with-border">
                            <i class="fa fa-user"></i> 当事人详情
                            <!-- <div class="box-tools pull-right">
                                 <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                 </button>
                             </div>-->
                        </div>
                        <div class="box-body">
                            <!-- Custom Tabs -->
                            <div class="nav-tabs-custom">
                                <ul class="nav nav-tabs" id="defendant-tab">
                                    <!--<li class="active"><a href="#defendant_name_1" data-toggle="tab">被申请人姓名 1</a></li>
                                    <li><a href="#defendant_name_2" data-toggle="tab">被申请人姓名 2</a></li>
                                    <li><a href="#defendant_name_3" data-toggle="tab">被申请人姓名 3</a></li>-->
                                </ul>
                                <!-- Tab panes -->
                                <div class="tab-content" id="defendant-info">
                                    <!--<div role="tabpanel" class="tab-pane active" id="home">...</div>
                                    <div role="tabpanel" class="tab-pane" id="profile">...</div>
                                    <div role="tabpanel" class="tab-pane" id="messages">...</div>
                                    <div role="tabpanel" class="tab-pane" id="settings">...</div>-->
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane active" id="defendant_name_1">
                                        <div class="box-body" style="padding: 10px 10px 0;" id="row_defendant"></div>
                                        <div class="overlay" id="loading_row_defendant">
                                            <i class="fa fa-spin fa-refresh"></i>
                                        </div>
                                    </div>
                                    <!-- /.tab-pane -->
                                    <div class="tab-pane" id="defendant_name_2">

                                    </div>
                                    <!-- /.tab-pane -->
                                    <div class="tab-pane" id="defendant_name_3">

                                    </div>
                                    <!-- /.tab-pane -->
                                </div>
                                <!-- /.tab-content -->
                            </div>
                            <!-- nav-tabs-custom -->
                        </div>
                    </div>
                </div>
                <!-- 左侧当事人详情主体结束 -->
                <!-- 右侧流转详情开始 -->
                <div class="col-lg-5">
                    <div class="box box-solid no-shadow">
                        <div class="box-header with-border">
                            <i class="fa fa-user"></i> 流转详情
                            <!-- <div class="box-tools pull-right">
                                 <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                                 </button>
                             </div>-->
                        </div>
                        <div class="box-body">
                            <div class="nav-tabs-custom">
                                <div class="modal-body">
                                    <ul class="timeline" id="ul_step"></ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--右侧流转详情结束-->
            </div>
        </section>
    </div>
    <footer class="main-footer"></footer>
</div>

<!-- jQuery 2.1.4 -->
<script src="res/plugins/jQuery/jQuery-2.1.4.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="res/plugins/jQueryUI/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<!-- Bootstrap 3.3.5 -->
<script src="res/bootstrap/js/bootstrap.min.js"></script>
<!-- iCheck 1.0.1 -->
<script src="res/plugins/iCheck/icheck.min.js"></script>
<!-- Select2 -->
<script src="res/plugins/select2/select2.full.min.js"></script>
<script src="res/plugins/select2/i18n/zh-CN.js"></script>
<!-- datetimepicker -->
<script src="res/plugins/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="res/plugins/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
<!-- Chart 2.7.2 -->
<script src="res/plugins/chart/Chart.bundle.js"></script>
<!-- fileupload -->
<script src="res/plugins/fileupload/jquery.ui.widget.js"></script>
<script src="res/plugins/fileupload/jquery.fileupload.js"></script>
<!-- Chart 2.7.2 -->
<script src="res/plugins/chart/Chart.bundle.min.js"></script>
<!-- switch -->
<script src="res/plugins/switch/bootstrap-switch.min.js"></script>
<!-- AdminLTE App -->
<script src="res/dist/js/app.min.js"></script>
<!-- 自定义 -->
<script src="self/js/head.js"></script>
<script src="self/js/self.js"></script>
<script src="self/js/sidebar.js"></script>
<script>
    $(function () {
        limitTime = "2018-10-01 23:59:59";
        initFormList();

        var view = getParameter("view");
        var isView = false;
        if (view != null && view != "") {
            isView = true;
        }

        var web = getParameter("web");
        initAccount(web);

        var casesId = getParameter("cases");
        alert(casesId)
        // 加载流程进度
        showCasesSetp(casesId);
        getCasesPersonnelList4Representative(casesId);
        getCasesPersonnelList(false, "loading_row_apply", casesId, "1");
        //              getCasesPersonnelList(false, "loading_row_apply_agent", casesId, "4");
        getCasesPersonnelList(false, "loading_row_apply_third_party", casesId, "7");
        getCasesPersonnelList(false, "loading_row_third_party", casesId, "3");
        //              getCasesPersonnelList(false, "loading_row_third_party_agent", casesId, "5");
        getCasesPersonnelList(false, "loading_row_defendant", casesId, "2");
        //              getCasesPersonnelList(false, "loading_row_defendant_agent", casesId, "6");
        initModal4AgentView();
        initToolBar(casesId);
        getCasesRemarkList(casesId);
        getCases("loading_info", casesId, true, true, false, "1", isView);

        getFileList("loading_info", "label_cases_file_9", "label-cases-file-9", "cases_file/files?mode=9&cases_id=" + casesId, true);
        getFileList("loading_info", "label_cases_file_1", "label-cases-file-1", "cases_file/files?mode=1&cases_id=" + casesId, true);
        getFileList("loading_info", "label_cases_file_3", "label-cases-file-3", "cases_file/files?mode=3&cases_id=" + casesId, true);
        getFileList("loading_info", "label_cases_file_7", "label-cases-file-7", "cases_file/files?mode=7&cases_id=" + casesId, true);
        getFileList("loading_info", "label_cases_file_2", "label-cases-file-2", "cases_file/files?mode=2&cases_id=" + casesId, true);

        //处理
        $(".btn-process-pre").on("click", function () {
            window.location.href = "audit_process_pre.html?web=" + web + "&cases=" + casesId + "&mode=" + $(this).data("mode");
        });

        //备注
        $("#modal_remark").on("show.bs.modal", function (event) {
            $("#remark_id").val(null);
            $("#remark_remark").val(null);

            var button = $(event.relatedTarget);
            if (button.data("type") != "1") {
                $("#remark_id").val(button.data("id"));
                $("#remark_remark").val(button.data("remark"));
            }
        });
        $("#btn_submit_remark").on("click", function () {
            $("#loading_info").show();
            $.ajax({
                url: "cases_remark/save",
                type: "post",
                dataType: "json",
                data: {
                    cases_id: casesId,
                    id: $("#remark_id").val(),
                    remark: $("#remark_remark").val()
                },
                success: function (data) {
                    $("#loading_info").hide();
                    if (data.result != 1) {
                        showMsg(data.error_msg);
                        return;
                    }

                    getCasesRemarkList(casesId);
                    $("#modal_remark").modal("hide");
                },
                error: function (xhr, type) {
                    $("#loading_info").hide();
                    showMsg("系统繁忙");
                }
            });
        });
    });

    $('body').on('hidden.bs.modal', function () {
        $('input:text').val('');
    });

    var html1 = '<div class="col-lg-3"  id="1"  style="">'
        + '       <div class="form-group">'
        + '           <label>姓名</label>'
        + '            <input class="form-control" id="agent_name2" name="agent_name2" />'
        + '        </div>'
        + '     </div>';
    var html2 = '     <div class="col-lg-3" id="2"  style="">'
        + '        <div class="form-group">'
        + '            <label>性别</label>'
        + '            <div class="form-control">'
        + '                <label style="padding-left: 7px"><input type="radio" class="minimal" name="agent_gender2"'
        + '                    value="1" checked="checked"> 男</label>'
        + '                <label style="padding-left: 7px"><input type="radio" class="minimal" name="agent_gender2"'
        + '                    value="2"> 女</label>'
        + '           </div>'
        + '       </div>'
        + '   </div>';

    var html3 = '   <div class="col-lg-6" id="3" style="">'
        + '       <div class="form-group">'
        + '           <label>工作单位</label>'
        + '         <input class="form-control" id="agent_unit_name2" name="agent_unit_name2" />'
        + '      </div>'
        + '  </div>';

    var html4 = '  <div class="col-lg-6" id="4" style="">'
        + '       <div class="form-group">'
        + '           <label>职务</label>'
        + ' <select class="form-control" style="width: 100%;" id="agent_id_type2" name="agent_id_type2">'
        + '<option value="1">律师</option>'
        + '<option value="2">法律工作者</option>'
        + '<option value="3">专职律师</option>'
        + '<option value="4">军队律师</option>'
        + '</select>'
        + '      </div>'
        + '   </div>';
    /*    var html5='  <div class="col-lg-3" id="5"  style="">'
                           +'       <div class="form-group">'
                           +'           <label>证件类型</label>'
                            +'          <select class="form-control" style="width: 100%;" id="agent_id_type" name="agent_id_type"></select>'
                           +'       </div>'
                            +'  </div>'; */
    var html5 = '  <div class="col-lg-3" id="5"  style="">'
        + '       <div class="form-group">'
        + '           <label>亲属关系</label>'

        + '       <input class="form-control" id="agent_kinsfolk" name="agent_kinsfolk" />'
        + '       </div>'
        + '  </div>';
    var html6 = '   <div class="col-lg-3" id="6"  style="">'
        + '      <div class="form-group">'
        + '          <label>证件号码</label>'
        + '          <input class="form-control" id="agent_id_no2" name="agent_id_no2" />'
        + '      </div>'
        + '   </div>';

    var html7 = '   <div class="col-lg-3" id="7"  style="">'
        + '      <div class="form-group">'
        + '         <label>联系方式</label>'
        + '          <input class="form-control" id="agent_phone2" name="agent_phone2" />'
        + '      </div>'
        + '  </div>';

    /*  var html8='   <div class="col-lg-3" style="display:none" id="8" >'
                           +'       <div class="form-group">'
                           +'           <label>其他联系方式</label>'
                            +'          <input class="form-control" id="agent_contact" name="agent_contact" />'
                            +'      </div>'
                            +'  </div>'; */

    var html9 = '  <div class="col-lg-4" id="9"  style="">'
        + '     <div class="form-group">'
        + '         <label>出生日期 <small>（格式：2018-01-01）</small></label>'
        + '         <input class="form-control" id="agent_birthday2" name="agent_birthday2" />'
        + '     </div>'
        + ' </div>';
    var html10 = '  <div class="col-lg-8" id="210"  style="">'
        + '     <div class="form-group">'
        + '          <label>联系地址</label>'
        + '         <div class="input-group">'
        + '             <div class="input-group-addon">省</div>'
        + '             <select class="select2" style="width: 100%;" id="agent_province"></select>'
        + '             <div class="input-group-addon">市</div>'
        + '            <select class="select2" style="width: 100%;" id="agent_city"></select>'
        + '            <div class="input-group-addon">区/县</div>'
        + '             <select class="select2" style="width: 100%;" id="agent_county"></select>'
        + '          </div>'
        + '      </div>'
        + '   </div>';

    var html11 = '    <div class="col-lg-4" id="11" style="">'
        + '        <div class="form-group">'
        + '            <label>户籍所在地</label>'
        + '            <input class="form-control" id="apply_domicile2" name="apply_domicile2" />'
        + '        </div>'
        + '    </div>';

    var html12 = '    <div class="col-lg-4" id="12"  >'
        + '        <div class="form-group">'
        + '            <label>当事人所在社区</label>'
        + '            <input class="form-control" id="agent_szsq2" name="agent_szsq2" />'
        + '        </div>'
        + '    </div>';

    var html13 = '   <div class="col-lg-8" id="13"  style="">'
        + '        <div class="form-group">'
        + '           <label>通讯地址</label>'
        + '           <input class="form-control" id="agent_address2" name="agent_address2" />'
        + '       </div>'
        + '   </div>';

    var html14 = '    <div class="col-lg-12"  id="14">'
        + '       <div class="form-group">'
        + '           <label>单位以及有关社会团体推荐书（选填）</label>'
        + '          <div style="border: 1px solid #d2d6de;padding: 10px 0 0 10px;">'
        + '              <ul class="mailbox-attachments clearfix" id="ul_agent_file_3">'
        + '                   <li style="width: auto;">'
        + '                       <div class="mailbox-attachment-info">'
        + '                          <div class="mailbox-attachment-name" style="overflow: hidden;height: 25px;"><i class="fa fa-paperclip"></i> 选择文件</div>'
        + '                           <span class="mailbox-attachment-size">'
        + '                           <button class="btn btn-xs btn-skin btn-primary btn-file">'
        + '                              <i class="fa fa-plus"></i> 添加'
        + '                              <input type="file" id="agent_file_3" />'
        + '                          </button>'
        + '                       </span>'
        + '                       </div>'
        + '                   </li>'
        + '               </ul>'
        + '           </div>'
        + '       </div>'
        + '    </div>';

    var html15 = '   <div class="col-lg-12"  id="15" style="">'
        + '       <div class="form-group">'
        + '          <label>亲属关系证明材料（选填）</label>'
        + '          <div style="border: 1px solid #d2d6de;padding: 10px 0 0 10px;">'
        + '            <ul class="mailbox-attachments clearfix" id="ul_agent_file_4">'
        + '                <li style="width: auto;">'
        + '                     <div class="mailbox-attachment-info">'
        + '                         <div class="mailbox-attachment-name" style="overflow: hidden;height: 25px;"><i class="fa fa-paperclip"></i> 选择文件</div>'
        + '                          <span class="mailbox-attachment-size">'
        + '                         <button class="btn btn-xs btn-skin btn-primary btn-file">'
        + '                             <i class="fa fa-plus"></i> 添加'
        + '                              <input type="file" id="agent_file_4" />'
        + '                          </button>'
        + '                     </span>'
        + '                     </div>'
        + '                 </li>'
        + '              </ul>'
        + '          </div>'
        + '      </div>'
        + '   </div>';

    var html16 = '  <div class="col-lg-12"  id="16" style="display:none" >'
        + '     <div class="form-group">'
        + '        <label>单位公函</label>'
        + '        <div style="border: 1px solid #d2d6de;padding: 10px 0 0 10px;">'
        + '           <ul class="mailbox-attachments clearfix" id="ul_agent_file_5">'
        + '               <li style="width: auto;">'
        + '                   <div class="mailbox-attachment-info">'
        + '                      <div class="mailbox-attachment-name" style="overflow: hidden;height: 25px;"><i class="fa fa-paperclip"></i> 选择文件</div>'
        + '                      <span class="mailbox-attachment-size">'
        + '                      <button class="btn btn-xs btn-skin btn-primary btn-file">'
        + '                          <i class="fa fa-plus"></i> 添加'
        + '                          <input type="file" id="agent_file_5" />'
        + '                       </button>'
        + '                   </span>'
        + '                   </div>'
        + '               </li>'
        + '           </ul>'
        + '      </div>'
        + '    </div>'
        + '   </div>';

    var html17 = '   <div class="col-lg-12"  id="17"  style="">'
        + '      <div class="form-group">'
        + '          <label>证件信息</label>'
        + '          <div style="border: 1px solid #d2d6de;padding: 10px 0 0 10px;">'
        + '             <ul class="mailbox-attachments clearfix" id="ul_agent_file_6">'
        + '                 <li style="width: auto;">'
        + '                     <div class="mailbox-attachment-info">'
        + '                         <div class="mailbox-attachment-name" style="overflow: hidden;height: 25px;"><i class="fa fa-paperclip"></i> 选择文件</div>'
        + '                        <span class="mailbox-attachment-size">'
        + '                         <button class="btn btn-xs btn-skin btn-primary btn-file">'
        + '                             <i class="fa fa-plus"></i> 添加'
        + '                             <input type="file" id="agent_file_6" />'
        + '                           </button>'
        + '                        </span>'
        + '                      </div>'
        + '                   </li>'
        + '                 </ul>'
        + '             </div>'
        + '       </div>'
        + '    </div>';

    var html18 = '    <div class="col-lg-12"  id="18"  style="">'
        + '       <div class="form-group no-margin">'
        + '           <label>委托代理书</label>'
        + '          <div style="border: 1px solid #d2d6de;padding: 10px 0 0 10px;">'
        + '            <ul class="mailbox-attachments clearfix" id="ul_agent_file_7">'
        + '                  <li style="width: auto;">'
        + '                      <div class="mailbox-attachment-info">'
        + '                        <div class="mailbox-attachment-name" style="overflow: hidden;height: 25px;"><i class="fa fa-paperclip"></i> 选择文件</div>'
        + '                         <span class="mailbox-attachment-size">'
        + '                         <button class="btn btn-xs btn-skin btn-primary btn-file">'
        + '                            <i class="fa fa-plus"></i> 添加'
        + '                            <input type="file" id="agent_file_7" />'
        + '                       </button>'
        + '                    </span>'
        + '                   </div>'
        + '                </li>'
        + '          </ul>'
        + '      </div>'
        + '   </div>'
        + '   </div>';


    function changeImg(val) {
        if (val == '1') {
            $('#agent_id_type2 option:eq(0)').prop('selected', 'selected');
            $('#center1').css('position', '');
            $('#center1').css('z-index', '0');
            $('#center2').css('position', 'absolute');
            $('#center2').css('z-index', '-110');
            $('#center3').css('position', 'absolute');
            $('#center3').css('z-index', '-200');
        } else if (val == '2') {
            $('#center1').css('position', 'absolute');
            $('#center1').css('z-index', '-100');
            $('#center2').css('position', '');
            $('#center2').css('z-index', '0');
            $('#center3').css('position', 'absolute');
            $('#center3').css('z-index', '-200');
        } else if (val == '3') {
            $('#center1').css('position', 'absolute');
            $('#center1').css('z-index', '-100');
            $('#center2').css('position', 'absolute');
            $('#center2').css('z-index', '-200');
            $('#center3').css('position', '');
            $('#center3').css('z-index', '0');
        }
    }

    /**
     * 流程详情
     * @param casesId 当前案件id
     */
    function showCasesSetp(casesId) {
        $.ajax({
            url: "cases_step/get_list",
            type: "post",
            dataType: "json",
            data: {
                cases_id: casesId
            },
            success: function (data) {
                if (data.result != 1) {
                    showMsg(data.error_msg);
                    return;
                }
                $(".li-step").remove();
                if (data.data != null && data.data.length > 0) {
                    $.each(data.data, function (index, value) {
                        var lebal = getStateLabel(value.state, true);
                        var label_account = "";
                        if (value.label_account != null && value.label_account != "") {
                            label_account = "<div class='pull-right'><label class='label label-info' style='border-radius: 0px;'>" + value.label_department + "</label>" +
                                "<label class='label label-default' style='border-radius: 0px;'>" + value.label_account + "</label><div>";
                        }
                        var $li = $("<li class='li-step'>" +
                            "<i class='fa fa-clock-o'></i>" +
                            "<div class='timeline-item no-shadow' style='border: 1px solid #eee;'>" +
                            "<div class='timeline-header' style='border-bottom: 0px;'>" +
                            lebal + "<label class='label label-default' style='border-radius: 0px;'>" + value.create_time + "</label>" + label_account +
                            "</div>" +
                            "</div>" +
                            "</li>");
                        $("#ul_step").append($li);
                    });
                }
            },
            error: function (xhr, type) {
                showMsg("系统繁忙");
            }
        });
    }
</script>
</body>

</html>